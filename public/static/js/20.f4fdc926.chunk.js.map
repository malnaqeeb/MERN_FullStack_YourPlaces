{"version":3,"sources":["places/pages/UpdatePlace.js","shared/component/UIElements/Card.js"],"names":["UpdatePlace","auth","useContext","AuthContext","placeId","useParams","history","useHistory","useHttpClient","isLoading","error","sendRequest","clearError","useState","place","setPlace","tags","setTags","useFrom","title","value","isValid","description","state","inputHandler","setFormData","useEffect","a","process","data","getPlace","className","handleTagChange","event","tagName","target","name","checked","oldTags","includes","filter","tag","tagInputs","PLACE_TAGS","forEach","tagInput","key","onChange","inputProps","push","onClear","onSubmit","preventDefault","JSON","stringify","inputs","Authorization","token","userId","updatePlace","id","element","type","label","validators","VALIDATOR_REQUIRE","errorText","onInput","initailValue","initailValid","VALIDATOR_MINLENGTH","disabled","Card","props","style","children"],"mappings":"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","file":"static/js/20.f4fdc926.chunk.js","sourcesContent":["import React, { useEffect, useState, Fragment, useContext } from \"react\";\r\nimport { useParams, useHistory } from \"react-router-dom\";\r\nimport Input from \"../../shared/component/formElements/Input\";\r\nimport Button from \"../../shared/component/formElements/Button\";\r\nimport Card from \"../../shared/component/UIElements/Card\";\r\nimport LoadingSpinner from \"../../shared/component/UIElements/LoadingSpinner\";\r\nimport ErrorModal from \"../../shared/component/UIElements/ErrorModal\";\r\nimport useHttpClient from \"../../shared/hooks/http-hook\";\r\nimport { AuthContext } from \"../../shared/context/auth-context\";\r\nimport {\r\n  VALIDATOR_REQUIRE,\r\n  VALIDATOR_MINLENGTH,\r\n} from \"../../shared/Util/validators\";\r\nimport { useFrom } from \"../../shared/hooks/form-hook\";\r\nimport { PLACE_TAGS } from \"../../shared/Util/constants\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport \"./NewPlace.css\";\r\n\r\nconst UpdatePlace = () => {\r\n  const auth = useContext(AuthContext);\r\n\r\n  const placeId = useParams().placeId;\r\n  const history = useHistory();\r\n\r\n  const { isLoading, error, sendRequest, clearError } = useHttpClient();\r\n  const [place, setPlace] = useState();\r\n  const [tags, setTags] = useState();\r\n  const [state, inputHandler, setFormData] = useFrom(\r\n    {\r\n      title: {\r\n        value: \"\",\r\n        isValid: false,\r\n      },\r\n      description: {\r\n        value: \"\",\r\n        isValid: false,\r\n      },\r\n    },\r\n    false\r\n  );\r\n\r\n  useEffect(() => {\r\n    const getPlace = async () => {\r\n      try {\r\n        const data = await sendRequest(\r\n          `${process.env.REACT_APP_BACKEND_URL}/places/${placeId}`\r\n        );\r\n        setPlace(data.place);\r\n        setTags(data.place.tags);\r\n        setFormData(\r\n          {\r\n            title: {\r\n              value: data.place.title,\r\n              isValid: true,\r\n            },\r\n            description: {\r\n              value: data.place.description,\r\n              isValid: true,\r\n            },\r\n          },\r\n          true\r\n        );\r\n      } catch (error) {}\r\n    };\r\n    getPlace();\r\n  }, [sendRequest, placeId, setFormData]);\r\n\r\n  if (isLoading)\r\n    return (\r\n      <div className=\"center\">\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n\r\n  if (!place && !error) {\r\n    return (\r\n      <div className=\"center\">\r\n        <Card>\r\n          <h2>Could not find place!</h2>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleTagChange = (event) => {\r\n    const tagName = event.target.name;\r\n\r\n    const checked = event.target.checked;\r\n    if (checked) {\r\n      setTags((oldTags) => {\r\n        return oldTags.includes(tagName) ? oldTags : [...oldTags, tagName];\r\n      });\r\n    } else {\r\n      setTags((oldTags) => {\r\n        return oldTags.includes(tagName)\r\n          ? oldTags.filter((tag) => tag !== tagName)\r\n          : oldTags;\r\n      });\r\n    }\r\n  };\r\n\r\n  const placeUpdateSubmitHandler = (event) => {\r\n    event.preventDefault();\r\n    const updatePlace = async () => {\r\n      try {\r\n        await sendRequest(\r\n          `${process.env.REACT_APP_BACKEND_URL}/places/${placeId}`,\r\n          \"PATCH\",\r\n          JSON.stringify({\r\n            title: state.inputs.title.value,\r\n            description: state.inputs.description.value,\r\n          }),\r\n          {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: \"Bearer \" + auth.token,\r\n          }\r\n        );\r\n        history.push(\"/\" + auth.userId + \"/places\");\r\n      } catch (error) {}\r\n    };\r\n    updatePlace();\r\n  };\r\n\r\n  const tagInputs = [];\r\n\r\n  if (place) {\r\n    PLACE_TAGS.forEach((tag) => {\r\n      const checked = tags && tags.includes(tag.name);\r\n      const tagInput = (\r\n        <span key={tag.name}>\r\n          <label>\r\n            <Checkbox\r\n              name={tag.name}\r\n              checked={!!checked}\r\n              onChange={handleTagChange}\r\n              inputProps={{ \"aria-label\": \"primary checkbox\" }}\r\n            />\r\n            {tag.title}\r\n          </label>\r\n          <span>&nbsp;&nbsp;</span>\r\n        </span>\r\n      );\r\n      tagInputs.push(tagInput);\r\n    });\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <ErrorModal error={error} onClear={clearError} />\r\n      {!isLoading && place && (\r\n        <form\r\n          className=\"place-form no-select\"\r\n          onSubmit={placeUpdateSubmitHandler}\r\n        >\r\n          <Input\r\n            id=\"title\"\r\n            element=\"input\"\r\n            type=\"text\"\r\n            label=\"Title\"\r\n            validators={[VALIDATOR_REQUIRE()]}\r\n            errorText=\"Please enter a valid title.\"\r\n            onInput={inputHandler}\r\n            initailValue={place.title}\r\n            initailValid={true}\r\n          />\r\n          <Input\r\n            id=\"description\"\r\n            element=\"textarea\"\r\n            label=\"Description\"\r\n            validators={[VALIDATOR_MINLENGTH(5)]}\r\n            errorText=\"Please enter a valid description (min. 5 characters).\"\r\n            onInput={inputHandler}\r\n            initailValue={place.description}\r\n            initailValid={true}\r\n          />\r\n          {tagInputs}\r\n          <Button type=\"submit\" disabled={!state.isValid}>\r\n            UPDATE PLACE\r\n          </Button>\r\n        </form>\r\n      )}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default UpdatePlace;\r\n","import React from 'react';\r\n\r\nimport './Card.css';\r\n\r\nconst Card = props => {\r\n  return (\r\n    <div className={`card ${props.className}`} style={props.style}>\r\n      {props.children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Card;\r\n"],"sourceRoot":""}